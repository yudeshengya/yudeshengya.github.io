(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{427:function(s,t,a){s.exports=a.p+"assets/img/image-20210226143555245.8839c2a6.png"},500:function(s,t,a){s.exports=a.p+"assets/img/image-20210214003229256.6d80f49c.png"},570:function(s,t,a){"use strict";a.r(t);var e=a(6),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"_1-构建-url"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-构建-url"}},[s._v("#")]),s._v(" 1. 构建 URL")]),s._v(" "),e("p",[s._v("当用户在地址栏输入一个查询关键字时，地址栏会判断输入的关键字是搜索内容还是请求URL。")]),s._v(" "),e("ul",[e("li",[s._v("如果是搜索内容，地址栏会使用浏览器默认的搜索引擎去合成URL")]),s._v(" "),e("li",[s._v("如果是请求URL，例如 "),e("code",[s._v("www.baidu.com")]),s._v("，那么地址栏会给这段 URL 加上协议，合成为完整的URL "),e("code",[s._v("https://www.baidu.com")])])]),s._v(" "),e("p",[s._v("完整的 URL 主要由："),e("strong",[s._v("协议、主机、端口、路径、查询参数")]),s._v("构成")]),s._v(" "),e("h2",{attrs:{id:"_2-查找强缓存"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-查找强缓存"}},[s._v("#")]),s._v(" 2. 查找强缓存")]),s._v(" "),e("p",[e("strong",[s._v("浏览器进程")]),s._v("会通过进程间通信（IPC）把 URL 发送给"),e("strong",[s._v("网络进程")]),s._v("，网络进程接收到 URL 并不会马上发送请求，它会先尝试查找本地缓存")]),s._v(" "),e("ul",[e("li",[s._v("如果有缓存资源，那么直接将缓存资源返回给浏览器进程。")]),s._v(" "),e("li",[s._v("如果没有缓存，那么进入网络请求流程。")])]),s._v(" "),e("h2",{attrs:{id:"_3-dns-解析"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-dns-解析"}},[s._v("#")]),s._v(" 3. DNS 解析")]),s._v(" "),e("p",[s._v("由于我们输入的一般是域名，而数据包是通过 IP 地址传给对方的。因此我们需要得到域名对应的 IP 地址。这个过程就需要用到 "),e("strong",[s._v("DNS 域名解析系统")]),s._v("。")]),s._v(" "),e("p",[s._v("另外，浏览器提供了"),e("strong",[s._v("DNS缓存功能")]),s._v("，如果一个域名已经解析过了，那么浏览器会将解析结果缓存起来，下次处理时直接从缓存中拿取数据，不需要经过 DNS 解析。")]),s._v(" "),e("p",[s._v("整个 DNS 查询过程如下：")]),s._v(" "),e("ol",[e("li",[s._v("首先查找浏览器 "),e("strong",[s._v("DNS 缓存")]),s._v("，如果有，则域名解析流程结束；否则进入下一步")]),s._v(" "),e("li",[s._v("读取操作系统的 "),e("strong",[s._v("hosts 文件")]),s._v("查找是否有对应的映射关系，有的话流程结束；否则进入下一步")]),s._v(" "),e("li",[s._v("查找"),e("strong",[s._v("本地域名服务器")]),s._v("，有的话流程结束；否则进入下一步")]),s._v(" "),e("li",[s._v("向"),e("strong",[s._v("根域名服务器")]),s._v("查询顶级域（例如 .com）的 IP 地址，然后在向"),e("strong",[s._v("顶级域名服务器")]),s._v("查询二级域名（例如 baidu.com）的 IP 地址，最后向"),e("strong",[s._v("权威域名服务器")]),s._v("查询完整域名的 IP 地址。")])]),s._v(" "),e("h2",{attrs:{id:"_4-建立-tcp-连接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-建立-tcp-连接"}},[s._v("#")]),s._v(" 4. 建立 TCP 连接")]),s._v(" "),e("p",[s._v("由于 HTTP 请求是建立在 TCP/IP 之上的，所以需要先建立 TCP 连接。")]),s._v(" "),e("p",[s._v("对于 TCP 建立连接的过程，是通过三次握手进行协商建立的，具体如下。")]),s._v(" "),e("img",{staticStyle:{zoom:"67%"},attrs:{src:a(500),alt:"image-20210214003229256"}}),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("keep-alive\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h2",{attrs:{id:"_5-建立-tls-连接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-建立-tls-连接"}},[s._v("#")]),s._v(" 5. 建立 TLS 连接")]),s._v(" "),e("p",[s._v("如果此时发现请求协议是 HTTPS，那么还需要建立 TLS 连接。")]),s._v(" "),e("p",[s._v("TLS 握手是为了证明服务器的真实性以及协商出会话密钥")]),s._v(" "),e("img",{staticStyle:{zoom:"80%"},attrs:{src:a(427),alt:"image-20210226143555245"}}),s._v(" "),e("h2",{attrs:{id:"_6-发送-http-请求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-发送-http-请求"}},[s._v("#")]),s._v(" 6. 发送 HTTP 请求")]),s._v(" "),e("p",[s._v("完成 TCP 连接之后，浏览器可以与服务器开始通信了，也就可以发送 HTTP 请求。浏览器会构建请求报文，而请求报文一般由"),e("strong",[s._v("请求行")]),s._v("、"),e("strong",[s._v("请求头")]),s._v("、"),e("strong",[s._v("请求体")]),s._v("等信息组成。")]),s._v(" "),e("p",[e("strong",[s._v("请求行")]),s._v("的格式如下，其中  GET 为请求方法，路径为根路径，HTTP 协议版本为 1.1")]),s._v(" "),e("div",{staticClass:"language-http line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[s._v("GET / HTTP/1.1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("请求头")]),s._v("的格式如下，另外对于 "),e("strong",[s._v("Cache-Control")]),s._v("、"),e("strong",[s._v("If-Modified-Since")]),s._v("、"),e("strong",[s._v("If-None-Match")]),s._v(" 都有可能会放入请求头信息中去向服务器询问缓存的情况。当然也有其他请求头，例如紧跟域名的 Cookie")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\nAccept-Encoding: gzip, deflate, br\nAccept-Language: zh-CN,zh;q=0.9,en;q=0.8\nCache-Control: max-age=0\nConnection: keep-alive\nCookie: cookie\nHost: www.baidu.com\nsec-ch-ua: "Google Chrome";v="87", " Not;A Brand";v="99", "Chromium";v="87"\nsec-ch-ua-mobile: ?0\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: none\nSec-Fetch-User: ?1\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("p",[s._v("对于"),e("strong",[s._v("请求体")]),s._v("的话，请求体存在于 POST 方法中。")]),s._v(" "),e("h2",{attrs:{id:"_7-响应-http-请求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_7-响应-http-请求"}},[s._v("#")]),s._v(" 7. 响应 HTTP 请求")]),s._v(" "),e("p",[s._v("对于 HTTP 响应报文，它同样由"),e("strong",[s._v("响应行")]),s._v("、"),e("strong",[s._v("响应头")]),s._v("、"),e("strong",[s._v("响应体")]),s._v("构成。")]),s._v(" "),e("p",[s._v("响应行格式：由 HTTP 协议版本、状态码和状态描述组成")]),s._v(" "),e("div",{staticClass:"language-http line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[e("span",{pre:!0,attrs:{class:"token response-status"}},[s._v("HTTP/1.1 "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v("200 OK")])]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("响应头类似下面这样，对于 "),e("strong",[s._v("Cache-Control")]),s._v("、"),e("strong",[s._v("Expires")]),s._v("、"),e("strong",[s._v("Last-Modified")]),s._v("、"),e("strong",[s._v("ETag")]),s._v(" 都有可能会放入响应头信息中通知浏览器如何缓存这些资源。当然还有很多其他头信息，例如 Set-Cookie 来设置 Cookie 信息。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("Bdpagetype: 2\nBdqid: 0xed681f84001f87c9\nCache-Control: private\nConnection: keep-alive\nContent-Encoding: gzip\nContent-Type: text/html;charset=utf-8\nDate: Fri, 12 Feb 2021 17:16:00 GMT\nExpires: Fri, 12 Feb 2021 17:16:00 GMT\nServer: BWS/1.1\nSet-Cookie: H_PS_PSSID=33423_33429_33272_31660; path=/; domain=.baidu.com\nStrict-Transport-Security: max-age=172800\nTraceid: 1613150160034475034617106957836365039561\nTransfer-Encoding: chunked\nX-Ua-Compatible: IE=Edge,chrome=1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("p",[s._v("响应头信息中还有一个重要的字段 "),e("strong",[s._v("Content-Type")]),s._v("，它告诉浏览器服务器返回的响应体数据是什么类型。如果 Content-Type 的值为 "),e("strong",[s._v("text-html")]),s._v("，那么会通知浏览器进程准备渲染进程准备渲染。")]),s._v(" "),e("p",[s._v("另外，如果状态码是301或302，那么会进行重定向，从 Location 字段读取新的URL，然后重新发起请求。")])])}),[],!1,null,null,null);t.default=n.exports}}]);